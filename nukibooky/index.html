<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="src/icono.ico" type="image/x-icon">
    <title>NUKI BOOKY</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="fondoactual" class="fondo1"></div>
 
    <div id="presionar">
        <div id="logo"></div>
        <div class="contenido" id="contenido">
            <button id="botonequis"></button>

            <div class="circulo" id="circulo"></div>
            <h1 id="contador">00:00</h1>
            <div id="stickers">
                <div class="campana"></div>
                <div class="carita"></div>
            </div>
            <div class="botones">
                <button id="botonplay"></button>
            </div>

        </div>
    </div>
    
</body>
</html>

<script>
const contenido = document.getElementById('contenido');
const circulo = document.getElementById('circulo');
const contador = document.getElementById('contador');
const botonplay = document.getElementById('botonplay');
const botonequis = document.getElementById('botonequis');
const presionar = document.getElementById("presionar")
let nfondo = 1;
let xPorcentaje;
let yPorcentaje;
let iniciado = false;
let click=false;
let totalSegundos = 30 * 60; 
let colorPrincipal = 'var(--color1)';
let colorFondo = 'transparent';

function animar() {
    if (totalSegundos < 0) return;
    if (!iniciado) return;

    let minutos = Math.floor(totalSegundos / 60);
    let segundos = totalSegundos % 60;


    contador.textContent = `${String(minutos).padStart(2,'0')}:${String(segundos).padStart(2,'0')}`;
    contador.style.color = colorPrincipal
    botonequis.style.backgroundColor = colorPrincipal
    botonplay.style.backgroundColor = colorPrincipal

    let porcentaje = (totalSegundos / (5*60)) * 100; // 100% al inicio
    circulo.style.background = `conic-gradient(${colorPrincipal} ${porcentaje*3.6}deg, ${colorFondo} ${porcentaje*3.6}deg)`;

    totalSegundos--;
    if(iniciado){
        setTimeout(animar, 1000);
    }
}



   
    function nuevofondo(){
        if(click){
            return 0
        }
        click = true
        if(nfondo == 4){
            nfondo = 1;
        }else{
            nfondo++;
        }
        
        const fondoactual = document.getElementById("fondoactual")
        const fondocopia = document.createElement('div');
        fondocopia.id = "fondocopia"
        fondocopia.classList.add("fondo"+nfondo)
        fondocopia.style.left = xPorcentaje+"%"
        fondocopia.style.top = yPorcentaje+"%"
        fondocopia.addEventListener("animationend", function() {
            fondoactual.remove(); 
            fondocopia.id = "fondoactual"
            fondocopia.style.left = "0%"
            fondocopia.style.top = "0%"
            fondocopia.style.animation = " fondo 30s linear infinite"

            click = false
        });

        document.body.appendChild(fondocopia)
        colorPrincipal = "var(--color"+nfondo+")"
        if(!iniciado){
            contador.style.color = colorPrincipal
            botonequis.style.backgroundColor = colorPrincipal
            botonplay.style.backgroundColor = colorPrincipal
            circulo.style.backgroundColor = colorPrincipal
        }
        setTimeout(() => {
            fondocopia.style.animation = " fondo 30s linear infinite, aparecerfondo both 3s "
        }, 10);
        

    }
    document.addEventListener("mousemove", (e) => {
      const x = e.clientX;
      const y = e.clientY;
      xPorcentaje = ((x / window.innerWidth) * 100).toFixed(2);
        yPorcentaje = ((y / window.innerHeight) * 100).toFixed(2);
    });
    presionar.addEventListener("click", (e) => {
        if (e.target === presionar ||e.target ===  contenido) {
            nuevofondo();
        }
    });
    botonplay.addEventListener("click", function(){
        if(iniciado){
            iniciado = false

            botonplay.style.webkitMaskImage = "url(src/play.svg)";
            botonplay.style.maskImage = "url(src/play.svg)";
        }else{
            botonplay.style.webkitMaskImage = "url(src/pausa.svg)";
            botonplay.style.maskImage = "url(src/pausa.svg)";
            iniciado = true
            animar()
        }
    
    });
</script>